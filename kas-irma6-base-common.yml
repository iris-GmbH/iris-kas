# SPDX-License-Identifier: MIT
# Copyright (C) 2021 iris-GmbH infrared & intelligent sensors
#
#
# The KAS base configuration file for the irma6

header:
  version: 9
  includes:
    - "include/kas-irma6-base-config.yml"
    - "include/kas-targets.yml"

local_conf_header:
  distro_version: |
    # adjust on release and reintegrate
    IRMA6_DISTRO_VERSION = "3.0.2-RC1"

defaults:
  repos:
    patches:
      repo: "this"

repos:
  # the iris-kas repo
  this:
    path: ""
  # iris-specific repos
  meta-iris-base:
    url: "https://github.com/iris-GmbH/meta-iris-base.git"
    commit: "a49442d3598bdd68a919cefb2447842946ee623a"
  meta-iris-thirdparty:
    url: "https://github.com/iris-GmbH/meta-iris-thirdparty.git"
    commit: "f421d0d8fdb564ef427b1db3e4d52571271f1648"
  # general repos
  poky:
    url: "https://git.yoctoproject.org/git/poky"
    commit: "e51bf557f596c4da38789a948a3228ba11455e3c"
    layers:
      meta:
      meta-poky:
    patches:
      # backports for making hatchling python build backend work
      0001-python3-unittest-automake-output-add-new-recipe-for-:
        path: "patches/0001-python3-unittest-automake-output-add-new-recipe-for-.patch"
      0002-python3-calver-Add-recipe:
        path: "patches/0002-python3-calver-Add-recipe.patch"
      0003-Add-python3-editables-from-meta-python:
        path: "patches/0003-Add-python3-editables-from-meta-python.patch"
      0004-python3-trove-classifiers-Add-recipe:
        path: "patches/0004-python3-trove-classifiers-Add-recipe.patch"
      0005-Add-python3-pathspec-from-meta-python:
        path: "patches/0005-Add-python3-pathspec-from-meta-python.patch"
      0006-python3-pluggy-add-BBCLASSEXTEND-for-native-nativesd:
        path: "patches/0006-python3-pluggy-add-BBCLASSEXTEND-for-native-nativesd.patch"
      0007-Add-python3-hatchling-from-meta-oe:
        path: "patches/0007-Add-python3-hatchling-from-meta-oe.patch"
      0008-python3-hatch-vcs-add-new-recipe:
        path: "patches/0008-python3-hatch-vcs-add-new-recipe.patch"
      0009-python3-setuptools-scm-update:
        path: "patches/0009-python3-setuptools-scm-update.patch"
      0001-python3-manifest-add-ensurepip:
        path: "patches/0001-python3-manifest-add-ensurepip.patch"
  meta-openembedded:
    url: "https://git.openembedded.org/meta-openembedded"
    commit: "a88cb922f91fda95e8a584cee3092083d5ad3e98"
    layers:
      meta-oe:
      meta-python:
      meta-networking:
      meta-webserver:
      meta-filesystems:
    patches:
      # Backport and fix python3-platformdirs, dependency for python3-virtualenv,
      # in turn dependency for python3-tox
      0001-Backport-python3-platformdirs-to-kirkstone:
        path: "patches/0001-Backport-python3-platformdirs-to-kirkstone.patch"
      0001-Backport-python3-pytest-mock-to-kirkstone:
        path: "patches/0001-Backport-python3-pytest-mock-to-kirkstone.patch"
      0001-python3-pytest-cov-Add-initial-recipe-4.1.0:
        path: "patches/0001-python3-pytest-cov-Add-initial-recipe-4.1.0.patch"
      0002-python3-covdefaults-Add-initial-recipe-2.3.0:
        path: "patches/0002-python3-covdefaults-Add-initial-recipe-2.3.0.patch"
      0003-python3-platformdirs-Fix-recipe-version-3.6.0:
        path: "patches/0003-python3-platformdirs-Fix-recipe-version-3.6.0.patch"
      # Add python3-distlib, dependency for python3-virtualenv
      0001-python3-distlib-Add-initial-recipe-0.3.6:
        path: "patches/0001-python3-distlib-Add-initial-recipe-0.3.6.patch"
      # Add python3-filelock, dependency for python3-virtualenv and python3-tox
      0002-python3-filelock-Add-initial-recipe-3.12.0:
        path: "patches/0002-python3-filelock-Add-initial-recipe-3.12.0.patch"
      # Add python3-virtualenv, dependency for python3-tox
      0003-python3-virtualenv-Add-initial-recipe-20.23.0:
        path: "patches/0003-python3-virtualenv-Add-initial-recipe-20.23.0.patch"
      # Add python3-pyproject-api, dependency for python3-tox
      0004-python3-pyproject-api-Add-initial-recipe-1.5.1:
        path: "patches/0004-python3-pyproject-api-Add-initial-recipe-1.5.1.patch"
      # Add python3-tox
      0005-python3-tox-Add-initial-recipe-4.6.0:
        path: "patches/0005-python3-tox-Add-initial-recipe-4.6.0.patch"
      # Add patch for Json-schema.-validator
      0001-json-schema-validator-Updrade-to-2.2.0.patch:
        path: "patches/0001-json-schema-validator-Updrade-to-2.2.0.patch"
  meta-swupdate:
    url: "https://github.com/sbabic/meta-swupdate"
    commit: "7a85c71f40c4bf445f041fa7aad70733c9cbc0ba"
    patches:
      0001-Mongoose-Fix-request-handling:
        path: "patches/0001-APC-7142-Fix-request-handling-of-malformed-data.patch"
  meta-secure-imx:
    url: "https://source.denx.de/denx/meta-secure-imx.git"
    commit: "20d409a5e75758a8df7bb07e086a36377fbe16d9"
    patches:
      0001-APC-5918-Remove-bbappend-for-cryptsetup:
        path: "patches/0001-APC-5918-Remove-bbappend-for-cryptsetup.patch"
      0002-meta-secure-imx-Update-to-new-override-syntax:
        path: "patches/0002-meta-secure-imx-Update-to-new-override-syntax.patch"
  meta-virtualization:
    url: "https://git.yoctoproject.org/meta-virtualization"
    commit: "2d8b3cba8ff27c9ec2187a52b6a551fe1dcfaa07"

  # irma6 HWv1 repos
  lnxdsp-adi-meta:
    url: "https://github.com/analogdevicesinc/lnxdsp-adi-meta.git"
    commit: "ad2203c11723b07727589a8eebe33f3129cc236a"
    layers:
      meta-adi-adsp-sc5xx:
      meta-adi-external-toolchain:
    patches:
      0001-lnxdsp-adi-meta-Update-to-new-override-syntax:
        path: "patches/0001-lnxdsp-adi-meta-Update-to-new-override-syntax.patch"

  # irma6 HWv2 repos
  meta-freescale:
    url: "https://github.com/Freescale/meta-freescale.git"
    commit: "3e9ef23d98aa842cf84251a27c9b8dde8925ea61"
    patches:
      0001-Fix-compilation-of-fsl-image-mfgtool-initramfs:
        path: "patches/0001-Fix-compilation-of-fsl-image-mfgtool-initramfs.patch"
  meta-freescale-3rdparty:
    url: "https://github.com/Freescale/meta-freescale-3rdparty"
    commit: "1a6ea560015ecda5fff8eccaf5b1327f1bb6c57f"
  meta-freescale-distro:
    url: "https://github.com/Freescale/meta-freescale-distro"
    commit: "d5bbb487b2816dfc74984a78b67f7361ce404253"
